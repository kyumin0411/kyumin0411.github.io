---
title: "[SDS 실습 02] GCP에서 docker 생성"
---

# Docker 실습

GCP(Google Cloud Platform)에서 생성한 VM에 docker를 설치한 후,
docker의 여러 명령어들을 입력해보며 docker에 대한 이해도를 높이는 실습을 하고자 합니다.

모든 docker 명령어에 대한 정보는 아래 docker 공식 문서에서 참고할 수 있습니다. 실습 때는 핵심적인 명령어만 다루어 보도록 하겠습니다.

https://docs.docker.com/engine/reference/commandline/docker/

## 들어가기 앞서..

실습을 주로 포스팅 하기 위해서 서론은 최대한 줄이려고 하지만, 최소한 알고 가야 하는 개념을 조금 정리해보고자 합니다.

### docker container Life-cycle state

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/314c0a8c-c214-4ff6-a009-f3b43e7a3946/Untitled.png)


docker가 관리하는 container는 일련의 life-cycle state를 가집니다.

- **Created**: 컨테이너가 생성되었지만 시작하지는 않은 상태
- **Running**: 컨테이너 내부의 모든 프로세스를 스타트하여 running하는 상태
- **Paused**: 컨테이너 내부의 모든 프로세스가 멈춰있는 상태
- **Stopped**: 컨테이너 내부의 모든 프로세스가 정지된 상태
- **Deleted**: 컨테이너가 삭제되어 죽은 상태

### docker image

> docker image란?

docker image란 container를 구동하기 위해 필요한 프로그램, 소스, 유틸리티 등을 모은 파일 덩어리입니다.
즉 docker의 image는 하나의 틀을 제공하고, 그 틀 위에서 container는 실체화된 것이라고 이해하면 될 것 같습니다.

> 어떻게 docker image 생성하나?

docker를 build할 때 이미지가 생성됩니다.
보통 DockerFile을 이용해 build하고, DockerFile의 명령어 한줄씩 이미지 layer가 생성됩니다.
이 이미지 layer들은 하나의 이미지를 구성합니다.
여러 layer로 구성하는 이유는 변경사항이 없는 layer는 그대로 사용하고, 변경사항이 있는 layer만 재빌드하여 build 속도를 높일 수 있기 때문입니다.

> docker image는 어디에서 관리하나?

docker image들은 docker hub처럼, 원격 저장소에서 관리됩니다.
정확히는 이미지 layer 단위로 저장되어 관리되며, 여러 사용자들이 로컬 환경으로 pull 받아 사용할 수 있기에 CI/CD 방식에 적합합니다.

## VM 접속

이제 본격적으로 실습을 시작하겠습니다.
GCP의 VM Instance 조회 페이지에서 생성한 VM Instance들을 한눈에 확인할 수 있습니다.
VM Instance들의 표에 '연결'에 SSH 연결이 가능하도록 버튼이 활성화되어 있습니다. SSH 연결을 누르면 VM에 접속 가능한 터미널이 나옵니다.

<img width="1512" alt="스크린샷 2022-04-03 오후 7 18 29" src="https://user-images.githubusercontent.com/85981698/161424507-52179c90-5b8c-46b2-80ca-df9445920c86.png">


```
sudo -i
```

위 명령어를 입력하면 구글 계정의 사용자가 관리자 권한을 가진 관리자 모드로 변경됩니다.

<img width="1512" alt="스크린샷 2022-04-03 오후 7 19 14" src="https://user-images.githubusercontent.com/85981698/161424530-d484081e-a328-4c04-8627-f55651cca496.png">


## docker 설치

```
apt update
apt install -y docker.io
```

위 두 줄의 명령어를 입력합니다.
docker가 최신 상태를 유지할 수 있도록 update를 해준 후 docker를 설치합니다.

docker가 잘 설치되었는지 확인합니다.

<img width="1512" alt="스크린샷 2022-04-03 오후 7 25 22" src="https://user-images.githubusercontent.com/85981698/161424536-fed3a616-eefc-4c4c-b798-c3372eea3260.png">

